## 练习 10：变量只能保存值

好的，现在我们可以从人类那里获取输入并进行计算，我想要引起一些我的学生经常感到困惑的事情的注意。以下代码应该可以编译，但它可能不会按照你的期望工作。

我故意在代码中制造了一个*逻辑*错误。这不是语法问题（编译器关心的代码部分），也不是运行时错误，比如当人类在期望整数时，`Scanner`对象接收到了一个双精度数。这个逻辑错误是我设计指令流程的缺陷，导致输出不是我想要实现的。

```java
 1 import java.util.Scanner;
 2 
 3 public class Sequencing
 4 {
 5     public static void main( String[] args )
 6     {
 7         // BROKEN
 8 
 9         Scanner keyboard = new Scanner(System.in);
10         double price = 0, salesTax, total;
11 
12         salesTax = price * 0.0825;
13         total = price + salesTax;
14 
15         System.out.print( "How much is the purchase price? " );
16         price = keyboard.nextDouble();
17 
18         System.out.println( "Item price:\t" + price );
19         System.out.println( "Sales tax:\t" + salesTax );
20         System.out.println( "Total cost:\t" + total );
21     }
22 }
```

### 你应该看到什么

```java

How much is the purchase price? 7.99 Item price:  7.99
Sales tax:  0.0
Total cost:  0.0
```

你对输出感到惊讶吗？你是否期望$7.99 的销售税显示为$0.66 而不是一个大大的零？总成本应该是$8.65，对吧？发生了什么？

发生的是，在 Java（以及大多数编程语言中），*变量不能保存公式*。变量只能保存值。

看看第 12 行。我的学生有时会认为该行将公式`price * 0.0825`存储到变量 salesTax 中，然后稍后人类将值`7.99`存储到变量 price 中。他们认为在第 19 行打印 salesTax 时，计算机会以某种方式“运行”该公式。

实际上并不是这样的。事实上，这个程序甚至不应该编译。变量`price`在第 12 行甚至没有一个合适的值。它之所以有一个值，只是因为我在第 10 行做了一些狡猾的事情。

通常我们一直在程序的顶部声明变量，然后稍后初始化它们。但是在第 10 行，我声明了 price 并将其初始化为`0`。当你同时声明和初始化一个变量时，这被称为“定义”变量。salesTax 和 total 在这里没有定义

第 10 行，只是声明。

所以在第 16 行，人类输入的值并没有初始化 price；price 已经有了一个初始值（`0`）。但是人类输入的值（`7.99`或其他值）确实被存储到变量 price 中。

`0`被替换为`7.99`。

从第 10 行到第 15 行，变量 price 包含值`0`。当第 16 行开始执行并且我们在等待人类输入时，price 仍然包含`0`。但是当第 16 行完成时，无论人类输入了什么，都已经存储到 price 中，替换了零。然后从第 17 行到程序结束，变量 price 包含值`7.99`（或其他值）。

因此，考虑到这一点，我们可以弄清楚第 12 行实际发生了什么。第 12 行并没有将一个公式存储到 salesTax 中，但它确实存储了一个值。是什么值？它获取代码中此时变量 price 的值（即`0`），将其乘以`0.0825`（仍然是零），然后将这个零存储到 salesTax 中。

当第 12 行开始时，salesTax 的值是未定义的（salesTax 被声明但未定义）。到第 12 行结束时，salesTax 的值为`0`。没有一行代码改变了 salesTax（没有一行代码以`salesTax =`开头），因此该值永远不会改变，当它在第 19 行显示时，salesTax 仍然是零。

第 13 行也是类似的。它获取`price`的值**此时**（零），并将其加到`salesTax`的值**此时**（也是零）中，并将总和（零）存储到变量`total`中。`total`的值没有改变，`total`也不会以某种方式“记住”它的值来自涉及一些变量的公式。

这就是全部内容。变量保存值，而不是公式。计算机程序不是一组规则，它们是计算机按顺序执行的一系列指令，你代码中的后续操作取决于之前发生的事情。

### 学习演练

1.  删除第 10 行的`= 0`，这样`price`就不再在第 10 行定义，只是声明。当你尝试编译代码时会发生什么？错误消息是否合理？（现在将`= 0`放回，以便程序再次编译。）

1.  将给`salesTax`和`total`赋值的两行代码移到`price`获得适当值之后。确认程序现在按预期工作。

1.  现在这些行发生在`price`变量被正确赋予真实值之后，再次尝试删除第 10 行的`= 0`。程序是否仍然报错？你感到惊讶吗？

